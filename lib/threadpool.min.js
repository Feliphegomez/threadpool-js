"function"!=typeof Worker&&console&&console.log("Warning: Browser does not support web workers.");
(function(){function f(a,c){if("function"!=typeof c)throw Error("Expected callback function as parameter.");for(var b=0;b<a.length;b++)if(a[b]==c)return;a.push(c)}function g(a,c){for(var b=0;b<a.length;b++)a[b].apply(null,c)}var k="data:text/javascript;charset=utf-8,"+encodeURI("this.onmessage = function (event) {    var fnData = event.data.function;    var scripts = event.data.importScripts;    var fn = Function.apply(null, fnData.args.concat(fnData.body));    if(importScripts && importScripts.length > 0) {        importScripts.apply(null, scripts);    }    fn(event.data.parameter, function(result) {        postMessage(result);    });}"),d=
window.createBlobURL||window.createObjectURL;!d&&window.webkitURL&&(d=window.webkitURL.createObjectURL);if("function"==typeof BlobBuilder&&"function"==typeof d){var h=new BlobBuilder;h.append("this.onmessage = function (event) {    var fnData = event.data.function;    var scripts = event.data.importScripts;    var fn = Function.apply(null, fnData.args.concat(fnData.body));    if(importScripts && importScripts.length > 0) {        importScripts.apply(null, scripts);    }    fn(event.data.parameter, function(result) {        postMessage(result);    });}");
k=d(h.getBlob())}else"function"==typeof Blob&&"function"==typeof d&&(h=new Blob(["this.onmessage = function (event) {    var fnData = event.data.function;    var scripts = event.data.importScripts;    var fn = Function.apply(null, fnData.args.concat(fnData.body));    if(importScripts && importScripts.length > 0) {        importScripts.apply(null, scripts);    }    fn(event.data.parameter, function(result) {        postMessage(result);    });}"],{type:"text/javascript"}),k=d(h));var l=function(a,c){this.param=
c;this.importScripts=[];this.callbacksDone=[];this.callbacksError=[];if("function"==typeof a){var b=a.toString();this.scriptArgs=b.substring(b.indexOf("(")+1,b.indexOf(")")).split(",");this.scriptBody=b.substring(b.indexOf("{")+1,b.lastIndexOf("}"));this.scriptFile=void 0}else this.scriptBody=this.scriptArgs=void 0,this.scriptFile=a};l.prototype={getParameter:function(){return this.param},setParameter:function(a){this.param=a},getImportScripts:function(){return this.importScripts},setImportScripts:function(a){this.importScripts=
a},getFunction:function(){return!this.scriptArgs?void 0:{args:this.scriptArgs,body:this.scriptBody}},getScriptFile:function(){return this.scriptFile},triggerDone:function(a){g(this.callbacksDone,[a])},triggerError:function(a){g(this.callbacksError,[a])},done:function(a){f(this.callbacksDone,a)},error:function(a){f(this.callbacksError,a)}};var m=function(a){this.threadPool=a;this.currentJob=this.worker=void 0};m.prototype={run:function(a){function c(a){b.currentJob.triggerDone(a.data);b.threadPool.triggerDone(a.data);
b.currentJob=void 0;b.threadPool._threadDone(b)}var b=this;this.currentJob=a;a.getScriptFile()?(this.worker=new Worker(a.getScriptFile()),this.worker.addEventListener("message",c,!1),this.worker.postMessage(a.getParameter())):(this.worker=new Worker(k),this.worker.addEventListener("message",c,!1),this.worker.postMessage({"function":a.getFunction(),importScripts:a.getImportScripts(),parameter:a.getParameter()}))}};var e=function(a){this.size=a=a||e.defaultSize;this.pendingJobs=[];this.idleThreads=
[];this.callbacksDone=[];this.callbacksError=[];for(var c=0;c<a;c++)this.idleThreads.push(new m(this))};e.prototype={run:function(){var a=[].slice.call(arguments),c,b,d,e,f;if(1>arguments.length)throw Error("run(): Too less parameters.");if("string"==typeof a[0])c=a.shift();else if("object"==typeof a[0]&&a[0]instanceof Array&&(d=a.shift()),0<a.length&&"function"==typeof a[0])b=a.shift();else throw Error("run(): Missing obligatory thread logic function.");0<a.length&&"function"!=typeof a[0]&&(e=a.shift());
0<a.length&&"function"==typeof a[0]&&(f=a.shift());if(0<a.length)throw Error("run(): Unrecognized parameters: "+a);c?a=new l(c,e):(a=new l(b,e),d&&0<d.length&&a.setImportScripts(d));f&&a.done(f);this.pendingJobs.push(a);this.runJobs();return a},runJobs:function(){if(0<this.idleThreads.length&&0<this.pendingJobs.length){var a=this.idleThreads.shift(),c=this.pendingJobs.shift();a.run(c)}},_threadDone:function(a){this.idleThreads.push(a);this.runJobs()},triggerDone:function(a){g(this.callbacksDone,[a])},
triggerError:function(a){g(this.callbacksError,[a])},done:function(a){f(this.callbacksDone,a)},error:function(a){f(this.callbacksError,a)}};e.defaultSize=8;"function"==typeof define?define([],e):"object"==typeof window&&(window.ThreadPool=e)})();
